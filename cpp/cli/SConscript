# SConscript file for building cli.cpp
import os

# Import SCons symbols
from SCons.Script import Environment 


# Set build type: debug or release
import sys
build_type = ARGUMENTS.get('build', 'release')

if build_type == 'debug':
    env = Environment(CXXFLAGS=['-std=c++20', '-g', '-O0', '-DDEBUG'])
    print('Building in DEBUG mode')
else:
    env = Environment(CXXFLAGS=['-std=c++20', '-O2'])
    print('Building in RELEASE mode')

# Add include paths for CLI11.hpp and spdlog
cli11_include = os.path.join('lib', 'cli')
spdlog_include = os.path.join('lib/spdlog', 'include')
env.Append(CPPPATH=[cli11_include, spdlog_include])

# Source files
sources = ['cli.cpp', 
           'add.cpp', 
           'multiply.cpp', 
           'stacktrace.cpp', 
           'log.cpp', 
           
           ]

# Define FMT_HEADER_ONLY globally for all files
env.Append(CPPDEFINES=['FMT_HEADER_ONLY'])

# Build only the main CLI executable
env.Program(target='cli', source=sources)
